<!doctype html><html lang=en-us data-theme><head><meta charset=utf-8><meta name=HandheldFriendly content="True"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer-when-downgrade"><title>Volunteering With My Programming Skills For A Non-Commercial Radio Station - rickschubert.net blog</title><meta name=description content><link rel=icon type=image/x-icon href=https://rickschubert.net/blog/favicon.ico><link rel=apple-touch-icon-precomposed href=https://rickschubert.net/blog/favicon.png><link rel=stylesheet href=https://rickschubert.net/blog/css/style.min.ada65744b50c0c8e95fce70ffd6071f0d8830f31d28d4629c2a760b4cd8f97d1.css integrity><meta property="og:title" content="Volunteering With My Programming Skills For A Non-Commercial Radio Station"><meta property="og:description" content="During the Crimbo Limbo period between Christmas and New Years, I volunteered with my programming skills. That&rsquo;s how it came to be that I built a tool to create a browsable music library for the non-commercial radio station Great American Songbook. This article discusses why and how.
How I came to volunteer Building the tool Final thoughts How I came to volunteer For me, programming is like an itch. If I haven&rsquo;t programmed in a while I start to feel fidgety."><meta property="og:type" content="article"><meta property="og:url" content="https://rickschubert.net/blog/posts/volunteering-with-tech-skills-golang-music-library-reader/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-12-30T14:17:19+00:00"><meta property="article:modified_time" content="2020-12-30T14:17:19+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Volunteering With My Programming Skills For A Non-Commercial Radio Station"><meta name=twitter:description content="During the Crimbo Limbo period between Christmas and New Years, I volunteered with my programming skills. That&rsquo;s how it came to be that I built a tool to create a browsable music library for the non-commercial radio station Great American Songbook. This article discusses why and how.
How I came to volunteer Building the tool Final thoughts How I came to volunteer For me, programming is like an itch. If I haven&rsquo;t programmed in a while I start to feel fidgety."><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-252785X60E","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body><a class=skip-main href=#main>Skip to main content</a><div class=container><header class=common-header><div class=site-header><a class=site-title href=https://rickschubert.net/blog/>rickschubert.net blog</a>
<button class=theme-switcher></button>
<script>const moonSVG=`<svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path></svg>`,sunSVG=`<svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>`,STORAGE_KEY="user-color-scheme",defaultTheme="auto";let currentTheme,switchButton,autoDefinedScheme=window.matchMedia("(prefers-color-scheme: dark)");const autoChangeScheme=e=>{currentTheme=e.matches?"dark":"light",document.documentElement.setAttribute("data-theme",currentTheme),changeButtonText()};document.addEventListener("DOMContentLoaded",function(){switchButton=document.querySelector(".theme-switcher"),currentTheme=detectCurrentScheme(),currentTheme=="dark"&&document.documentElement.setAttribute("data-theme","dark"),currentTheme=="auto"&&(autoChangeScheme(autoDefinedScheme),autoDefinedScheme.addListener(autoChangeScheme)),changeButtonText(),switchButton.addEventListener("click",switchTheme,!1)});function detectCurrentScheme(){return localStorage.getItem(STORAGE_KEY)?localStorage.getItem(STORAGE_KEY):defaultTheme?defaultTheme:window.matchMedia?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":"light"}function changeButtonText(){switchButton.innerHTML=currentTheme=="dark"?moonSVG:sunSVG}function switchTheme(){currentTheme=="dark"?(localStorage.setItem(STORAGE_KEY,"light"),document.documentElement.setAttribute("data-theme","light"),currentTheme="light"):(localStorage.setItem(STORAGE_KEY,"dark"),document.documentElement.setAttribute("data-theme","dark"),currentTheme="dark"),changeButtonText()}</script></div></header><main id=main tabindex=-1><article class=post><header class=post-header><h1 class=post-title>Volunteering With My Programming Skills For A Non-Commercial Radio Station</h1></header><div class=content><p><a href="https://www.youtube.com/watch?v=Z3zD7z2vKZ8">During the Crimbo Limbo</a> period between Christmas and New Years, I volunteered with my programming skills. That&rsquo;s how it came to be that I built a tool to create a browsable music library for the non-commercial radio station <a href=https://greatamericansongbook.info>Great American Songbook</a>. This article discusses why and how.</p><ol><li><a href=#why>How I came to volunteer</a></li><li><a href=#tool>Building the tool</a></li><li><a href=#final>Final thoughts</a></li></ol><h2 id=a-namewhyahow-i-came-to-volunteer><a name=why></a>How I came to volunteer</h2><p>For me, programming is like an itch. If I haven&rsquo;t programmed in a while I start to feel fidgety. Furthermore, I am deeply passionate about automation and eliminating <a href=https://www.strike.coop/bullshit-jobs/>bullshit jobs</a>. This was actually how I started programming in the first place - back in my time when I was a linguist there had been dozens of manual tasks multiple people (including me) performed over and over. I got so annoyed by it that I taught myself how to program in order to get rid of these.</p><p>Volunteering was something I had considered already for a long time. I have approached multiple organisations over the past year, i.e. local hospitals at the height of coronavirus pressures. Most of the time, I either never heard back or have been told there was no need for help. It is surprising through how many hoops one has to jump just to work for free!</p><p>The Great American Songbook is a radio station I have been listening to for many years now. Swing music and dance are big passions for me. I donated some money to that radio station and that&rsquo;s how I thought again about volunteering: couldn&rsquo;t I donate my time and skills additionally to money? That&rsquo;s how I contacted the radio station and almost instantly received an answer.</p><p>During a zoom call, the radio producer walked me through the website&rsquo;s setup and how the radio stream operates. In my personal circle, I don&rsquo;t have many people of age and no one who could let alone operate a tablet. Therefore, I was incredibly impressed by the radio producer who is a pensioner and runs the radio station completely out of their own pocket. They have a setup of multiple servers, a website with SSH certificate, templates from GitHub, site updates using FTP, &mldr; - and they browsed through their media library using FreeCommander like a champ!</p><p>Our initial conversation immediately lay bare automation needs: On the website, there is a section which lists the complete music library. That way, listeners know what songs are available (and which aren&rsquo;t) so that they can request songs to be played more frequently or ask for new songs to be added to the rotation. Creating this PDF was a constant long-lasting pain to the radio producer, they only did it a few times a year because it took so long. This is where my tool comes in!</p><h2 id=a-nametoolabuilding-the-tool><a name=tool></a>Building the tool</h2><div class=callout>The code for this project is open-source and <a href=https://github.com/rickschubert/music-library-reader>can be found on GitHub</a>.</div><p>The task at hand was to crawl through the entire music collection of the radio producer and to generate a sorted list of all the tracks. This list should be sorted either by the artist or title. It should also be possible to exclude subdirectories from the generated catalogue.</p><p>It was clear to me that I wanted to have the catalogue displayed in an interactive table using HTML so that listeners can filter and sort easily. I also decided to add CSV export functionality to my tool so that the radio producer could still convert the list into a PDF if needed.</p><p>I wanted to build a tool which could be executed by the radio producer without any of my input - that&rsquo;s what automation is about after all: empowering the user. This is why I decided to use the Go programming language. Although I&rsquo;m an expert in JavaScript/TypeScript, it is not a great solution for tools that should be executed by people/machines outside your control. I wouldn&rsquo;t want to give the radio producer a list of things they need to install and commands they need to execute! With Go, I can compile the tool into one single executable file which the radio producer can start with a simple double click as they would do with any other program.</p><p>Once I knew all these requirements, I immediately started programming. I created a small command-line tool using the <a href=https://github.com/Songmu/prompter>prompter</a> library. I decided against any command-line flags and arguments as the tool was supposed to be used by non-techy people as well with just a double click. Therefore, I think it is way better to use a solution like prompter which asks the user for their input. That way, you can also give the user hints and examples. Unlike with avoidable <code>--help</code> messages, these prompts will definitely be seen by the user, there is no way around them. The prompter library is also incredibly easy to use:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>promptForDirectory</span>() <span style=color:#66d9ef>string</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>directory</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>prompter</span>.<span style=color:#a6e22e>Prompt</span>(
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;Please provide us with the path of the &#34;</span> <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;directory where all your music lies. I.e. C:\\Music&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>directory</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;&#34;</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>log</span>.<span style=color:#a6e22e>Fatal</span>(<span style=color:#e6db74>&#34;You need to enter a valid path&#34;</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>directory</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>One of the trickiest bits for me was to recursively iterate over all directories and subdirectories. I use the <code>filepath.Walk()</code> function which already works recursively out of the box! Due to my familiarity with JavaScript, I hadn&rsquo;t expected this though and assumed subdirectories were ignored. This is why I initially created unnecessary duplication where I would recursively call <code>filepath.Walk</code> again for every subdirectory - madness!</p><p>Golang is a highly readable programming language if done well - it requires the user to abstract things out a bit though. Consider the below code where I I try to determine whether a file path (<code>path</code>) starts with any item of the <code>ignoredDirectories</code> list. The code itself is quite readable but I have it placed in the midst of another function - I should have created a helper function called <code>Find()</code> instead. We live to make mistakes 🤷.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#75715e>// This should be its own function, something like `Find()`
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>shouldBeIgnored</span> <span style=color:#66d9ef>bool</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> <span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>ignoredDirectory</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>range</span> <span style=color:#a6e22e>ignoredDirectories</span> {
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#a6e22e>ignoredDirectory</span> <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#34;&#34;</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>strings</span>.<span style=color:#a6e22e>HasPrefix</span>(<span style=color:#a6e22e>strings</span>.<span style=color:#a6e22e>ToLower</span>(<span style=color:#a6e22e>path</span>), <span style=color:#a6e22e>strings</span>.<span style=color:#a6e22e>ToLower</span>(<span style=color:#a6e22e>ignoredDirectory</span>)) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>shouldBeIgnored</span> = <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Reading out artist name etc. from MP3 files was fairly straight-forward thanks to the <a href=https://github.com/dhowden/tag>tag</a> library. The same goes for creating CSV files which works with the built-in library <code>encoding/csv</code>.</p><p>More interesting - and challenging - was creating the catalogue as HTML table. Some people surely wonder whether I went with some grand solution like a serverless database and API calls to fetch items - way too complicated! Remember our goals: replacing the PDF file and empowering the radio producer. We wouldn&rsquo;t want to teach them about database access, requiring them to host things, or me hosting things for them which might not work any longer if I don&rsquo;t maintain it. Instead, I went for a simple and proven solution: Bake all the songs as table rows into a static HTML file.</p><p>The main idea of this tool was to have one single executable to give the radio producer. Therefore, having HTML mustache templates was out of the question as well. This is why I ended up hard-coding an actual string into my <code>.go</code> file which represents the base HTML skeleton. This skeleton is then enriched with all the table rows for each song where each item is converted into a <code>&lt;tr></code> element.</p><p>I initially created my own basic HTML table including custom filter functions but I was shocked by the atrocious performance of my naive scripts. The Great American Songbook music library contains 16.000 items - due to that size there is a need for smart filters. This is how I stumbled over the <a href=https://datatables.net/>DataTables project</a> which provides a fantastic out of the box solution for displaying tables, including pagination and filtering. Even on tables with 16.000 rows the search and sorting functionality works tremendously fast and stable.</p><p>While the filtering is fast, I had to do some trickery in regards to page loads. Because all of the <code>&lt;tr></code> elements are in the HTML page, the final page is 1.48MB large. This is a good decrease in size compared to the PDF (2.5MB) but it&rsquo;s still quite large to load for browsers. It turns out that if there are more than 16.000 elements on the page, your browser has to do quite a lot of work to process all of these items. This is why I had a look around and used the solution from <a href=https://patdavid.net/2019/02/displaying-a-big-html-table/>patdavid.net</a> where I first hide the table on page load. Instead, the site is showing a loading spinner. Once all elements are processed by the browser and in the DOM, I hide the loading spinner and display the table. I am using the jQuery event method <code>$(document).ready()</code> for that.</p><p>The end result works pretty well and the radio producer was very happy about it - what previously took hours became fully automated and finished in around 60 seconds!</p><h3 id=implementing-it-into-the-webpage>Implementing it into the webpage</h3><p>The radio producer told me that they would be able to implement the solution as iframe on the website - which was why I went with a separate HTML file to begin with. After a few hours, they contacted me though to ask whether I could help out integrating it. Of course I could!</p><p>Implementing the iframe into the existing website was quite tricky. The main problem was that I had to wrap my head around the website&rsquo;s framework which the radio producer purchased from another developer. While greatamericansongbook.info is a single-page application, there aren&rsquo;t any frameworks being used, it&rsquo;s all vanilla JavaScript: everything in jQuery, all scripts somewhat minified (highly shortened variable and function names but at least line breaks and indentation left intact). An extra pain point was that the website doesn&rsquo;t use any version control - it&rsquo;s just a bunch of files on an FTP server.</p><p>Another problem presented itself in having to have the iframe only loaded when the user requires to see it. As I discussed earlier, the HTML file for the table is very large. If you have an <code>iframe</code> element in your HTML file with a <code>src</code> attribute pointing to another page your browser will also load that other page though - even if the iframe isn&rsquo;t immediately visible to users. This is why the page loads were suddenly quite slow. I solved it by removing the <code>src</code> attribute from the <code>iframe</code> element in the initial HTML file. I managed to find in the source files the function which is being called whenever the URL changes. This is how I added another jQuery listener which only fires when the URL contains <code>#!/page_LIBRARY_TABLE</code> - in that case, I am adding to the <code>iframe</code> the <code>src</code> attribute leading to our big HTML table. Thus, the browser only loads our big table once it&rsquo;s necessary.</p><p>The final product looks something like this (might not be on the website yet, development version):</p><figure><img src=https://rickschubert.net/blog/images/gas_table_example.png><figcaption><h4>The iframe embedded into the Great American Songbook page</h4></figcaption></figure><h2 id=a-namefinalafinal-thoughts><a name=final></a>Final thoughts</h2><p>This was a fun and surprisingly challenging project which was right up my alley. I love that programming allows me to empower people: the radio producer doesn&rsquo;t have to spend hours anymore having to create a PDF library and the listeners can browse the entire catalogue with ease, allowing them to become more engaged.</p><p>Volunteering was a lot of fun and is something which I will want to do again. As outlined above, it isn&rsquo;t always that easy to find suitable projects. I think I got really lucky with how trusting and open the radio producer was. Even more so, they immediately grasped what I meant when I said &ldquo;I do automation&rdquo; and they had a fitting task for me in mind right away. Thank you very much!</p></div><div class=post-info><div class=post-date>30 December 2020</div><div class=post-taxonomies><ul class=post-tags><li><a href=https://rickschubert.net/blog/tags/programming>#programming</a></li></ul></div></div></article><div class="pagination post-pagination"><div class="left pagination-item"><a href=https://rickschubert.net/blog/posts/how-i-make-this-blog-with-gohugo/>How to make a blog such as this one with Hugo</a></div><div class="right pagination-item"><a href=https://rickschubert.net/blog/posts/flushing-promises/>Flushing Promises in JavaScript - what it is and why you need it in UI tests</a></div></div></main><footer class=common-footer><a class=rss href=https://rickschubert.net/blog/index.xml><img src=https://rickschubert.net/blog/images/rss.svg> Subscribe to RSS feed</a><nav><a href=https://rickschubert.net/blog/posts/ title=Archive>Archive</a></nav><div class=common-footer-bottom><div class=copyright><p>© Rick Schubert, 2022<br></p></div></div></footer></div></body></html>